<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: helpers/checkIpInList.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: helpers/checkIpInList.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

var _ = require('lodash');
var ip = require('ip');

/**
 * Checks if ip address is in list (e.g. whitelist, blacklist).
 * @param {array} list: an array of ip addresses or ip subnets
 * @param {string} addr: the ip address to check if in array
 * @param {boolean} [returnListIsEmpty=true] returnListIsEmpty: the return value, if list is empty
 * @return {boolean} true if ip is in the list, false otherwise
 */
function CheckIpInList (list, addr, returnListIsEmpty) {
	var i, n;

	if (!_.isBoolean(returnListIsEmpty)) {
		returnListIsEmpty = true;
	}

	if (!_.isArray(list) || list.length === 0) {
		return returnListIsEmpty;
	}

	if (!list._subNets) { // First call, create subnet list
		list._subNets = [];
		for (i = list.length - 1; i >= 0; i--) {
			var entry = list[i];
			if (ip.isV4Format(entry)) { // IPv4 host entry
				entry = entry + '/32';
			} else if (ip.isV6Format(entry)) { // IPv6 host entry
				entry = entry + '/128';
			}
			try {
				var subnet = ip.cidrSubnet(entry);
				list._subNets.push(subnet);
			} catch (err) {
				console.error('CheckIpInList:', err.toString());
			}
		}
	}

	if (list._subNets.length === 0) {
		return returnListIsEmpty;
	}

	// Check subnets
	for (i = 0, n = list._subNets.length; i &lt; n; i++) {
		if (list._subNets[i].contains(addr)) {
			return true;
		}
	}

	// IP address not found
	return false;
}

module.exports = CheckIpInList;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-app.html">app</a></li><li><a href="module-helper_httpApi.html">helper/httpApi</a></li></ul><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="account_.html">account</a></li><li><a href="Accounts.html">Accounts</a></li><li><a href="Field.html">Field</a></li><li><a href="git.js.html">js</a></li><li><a href="helper_router.html">helper/router</a></li><li><a href="Validator.html">Validator</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-account.logic_account.html">logic/account</a></li><li><a href="module-account.module_accounts.html">module/accounts</a></li><li><a href="module-helper_httpApi-middleware.html">middleware</a></li></ul><h3>Global</h3><ul><li><a href="global.html#beginEpochTime">beginEpochTime</a></li><li><a href="global.html#CheckIpInList">CheckIpInList</a></li><li><a href="global.html#getLastCommit">getLastCommit</a></li><li><a href="global.html#version">version</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Apr 11 2017 11:07:37 GMT-0300 (ART)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
